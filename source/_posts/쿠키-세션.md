---
title: 쿠키 세션
author : Ho9
date: 2019-07-11 14:02:43
tags:
- Cookie
- Session
- cache
---

##[웹] 쿠키 그리고 세션

---

웹에서 사용되는 쿠키, 세션에 대해 살포시 알아보자

---

쿠키와 세션에 대해 알아보기 전에 왜 사용하는지 부터 알아볼 필요가 있다고 생각한다.

<u>__쿠키와 세션을 왜 사용할까?__</u>

그 이유로는 HTTP 의 특징이자 약점을 보완하기 위해 사용된다.

####HTTP의 특징

1. 비연결지향(Connectionless)

연결 상태를 유지하지 않는 비연결성 프로토콜

요청을 받은 서버가 응답한 후 소켓을 유지하지 않고 disconnect 한다.

연결을 유지하게되면 리소스가 계속 사용되고 이를 방지하기위해 비연결 지향으로 설계
( HTTP1.1 부터는 keep-alive 헤더를 통해 연결을 유지할 수 있음 )

2. 상태정보유지안함(Statless)

연결을 끊는 순간 클아이언트와 서버의 통신이 끝나며 상태정보는 유지하지않는 특성.
따라서, 각각의 요청이 독립적으로 관리가 된다. 쉽게 말하면 이전 데이터 요청과 다음 데이터요청이 서로 관련이 없다.

위와 같은 리소스 낭비 측면에서 상당한 장점을 갖고 있지만, 통신할 때마다 새로 연결을 하기때문에 클라이언트는 매번 인증을 해야하는 단점이 생긴다.

이 단점을 보완하기위해 사용되는 세션과 쿠기에 대해서 알아보자.

####쿠키(Cookie)

쿠키는 서버가 클라이언트쪽에 저장하는 Key와 Value로 구성된 데이터 파일이다. 4KB 이상 크기로 저장할 수 없다.

쿠키는 클라이언트의 상태 정보를 로컬에 저장했다가 참조한다.

#####쿠키생성 및 활용 프로세스

1. 클라이언트가 서버에 요청을 하면 서버가 응답할 때 쿠키에 저장하고자 하는 정보는 Header의 `Set-Cookie`로 함께 전달.

2. 클라이언트는 서버로 전송하는 모든 요청에 현재 브라우저에 저장된 모든 쿠키를 Header의 `Cookie`로 전달.

3. 서버가 쿠키와 함께 응답을 클아이언트에게 전달하면 이후로는 해당 클라이언트는 매번 저장된 쿠키를 헤더에 포함해서 요청을 보내게 된다.

위와 같은 프로세스로 쿠키는 로그인상태유지, 팝업에서 '오늘 더이상 이 창을 보지않음', 장바구니와 같은 기능에 사용된다.

####세션(Session)

__일정 시간동안 같은 브라우저__ 로 부터 들어오는 일련의 요구를 __하나의 상태로 보고 그 상태를 유지하는 기술__

세션은 로그인 정보와 같은 인증 정보를 쿠키에 저장하지 않고 대신에 사용자의 식별자인 세션ID(Session ID)를 저장한다.

서버에서는 인증 정보와 더불어 이 ID에 해당하는 로그인 상태, 마지막 로그인시간, 만료기간 등의 정보를 저장한다. 보안상 서버는 사용자의 로컬보다는 상대적으로 안전하다고 볼 수 있다.

#####세션생성 및 활용프로세스

1. 클라이언트가 서버에 접속시 세션ID 발급

2. 서버에서는 클라이언트로 발급해준 세션ID를 쿠키를 사용해 저장 (ex. JSESSIONID)

3. 클라이언트는 다시 접속할 때, 이 쿠키를 이용하여 세션 ID 값을 서버에 전달.

간단히 말하면 정보는 서버에 저장해두고, 그 정보를 찾아갈 수 있는 지도(세션ID)는 쿠키에 담아서 클라이언트에게 보내준다 라고 생각하면 이해가 쉽다.


####쿠키와 세션의 차이

- __저장위치__
  - 쿠키는 클라이언트에 파일로 저장
  - 세션은 서버에 저장.

- __보안__
  - 쿠키는 클라이언트 로컬에 저장되기 때문에 변질되거나 request에서 스나이핑 당할 우려도 있어 보안에 취약
  - 세션은 쿠키를 이용해서 세션ID만  저장하고 이를 가지고 서버에서 사용자를 식별하기때문에 비교적 안전
- __라이프 사이클__
  - 쿠키는 만료시간이 있지만 파일로 저장되기때문에 브라우저를 종료해도 남아있을 수 있다.
  - 세션은 만료시간을 정할 수 있지만 브라우저가 종료되면 만료시간에 상관없이 삭제된다.
- __속도__
  - 쿠키는 쿠키에 정보가 있기때문에 서버에 요청이 속도가 상대적으로 빠르다.
  - 세션은 정보가 세션에 잇기때문에 처리가 요구되어 비교적 느리다.

- __세션만 사용해도 좋은데 쿠키가 사용되는 이유__
  - 세션은 서버의 자원을 사용하기때문에 무분별하게 사용하다보면 서버의 메모리자원에 부하를 줄 수 있기때문.










####참고

[Web-쿠키와 세션의 차이, 용도, 사용법](https://jeong-pro.tistory.com/80)

[쿠키(Cookie)와 세션(Session)&로그인 동작방법](https://cjh5414.github.io/cookie-and-session/)
